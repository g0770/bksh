{% extends "base.html" %}
{% block title %}Home – BKSH{% endblock %}
{% block content %}

<div class="section mb-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h4 class="text m-0">Mis últimos 5 libros</h4>
    <a class="btn btn-secondary" href="{{ url_for('my_books') }}">Ver todos los libros</a>
  </div>

  {% if last_5_mine %}
  <div class="row g-3">
    {% for b in last_5_mine %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card subCard p-3 h-100">
        <h5 class="text mb-1">{{ b.title }}</h5>
        {% if b.subtitle %}<p class="text mb-2">{{ b.subtitle }}</p>{% endif %}
        <small class="text d-block">Creado: {{ b.creation_date.strftime('%Y-%m-%d %H:%M') if b.creation_date else ''
          }}</small>
        <small class="text d-block">Actualizado: {{ b.last_update_date.strftime('%Y-%m-%d %H:%M') if b.last_update_date
          else '' }}</small>
        <div class="mt-3 d-flex gap-2">
          <a class="btn btn-outline-light" href="{{ url_for('book_detail', book_id=b.id) }}">Abrir</a>
          {% if b.creator_user_id == session.get('user_id') %}
          <a class="btn btn-outline-warning" href="{{ url_for('edit_book', book_id=b.id) }}">Editar</a>
          <form method="POST" action="{{ url_for('delete_book', book_id=b.id) }}"
            onsubmit="return confirm('¿Eliminar libro y todo su contenido?');">
            <button class="btn btn-danger">Borrar</button>
          </form>
          {% endif %}
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text m-0">Aún no creaste libros.</p>
  {% endif %}
</div>

<div class="section">
  <h4 class="text mb-3">Últimos 10 libros actualizados</h4>
  {% if last_10_updated %}
  <div class="row g-3">
    {% for b in last_10_updated %}
    <div class="col-12 col-md-6 col-lg-4">
      <div class="card subCard p-3 h-100">
        <h5 class="text mb-1">{{ b.title }}</h5>
        {% if b.subtitle %}<p class="text mb-2">{{ b.subtitle }}</p>{% endif %}
        <small class="text d-block">Actualizado: {{ b.last_update_date.strftime('%Y-%m-%d %H:%M') if b.last_update_date
          else '' }}</small>
        <a class="btn btn-outline-light mt-3" href="{{ url_for('book_detail', book_id=b.id) }}">Ver</a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p class="text m-0">No hay actualizaciones recientes.</p>
  {% endif %}
</div>

{% endblock %}